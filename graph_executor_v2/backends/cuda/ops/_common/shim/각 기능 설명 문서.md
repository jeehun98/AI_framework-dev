# ğŸ“¦ _common/shim â€” ëª¨ë“ˆ ì¸ë±ìŠ¤

## ai_defs.hpp
- ëª©ì : CUDA í•œì •ì/ì¸ë¼ì¸ ë§¤í¬ë¡œ ë³´ì •, `AI_RD/AI_INLINE` ë‹¨ì¼ ì†ŒìŠ¤.
- ë¹„ê³ : ëª¨ë“  shim í—¤ë”ëŠ” ì´ê±¸ ë¨¼ì € include.

## ai_status.hpp
- ëª©ì : ê³µí†µ `Status` ì—´ê±°, `AI_RETURN_IF_ERROR`.

## ai_device.hpp
- ëª©ì : `Device/DType/Layout` ë‹¨ì¼ ì†ŒìŠ¤ + `dtype_size/numel_of/safe_mul_nonneg`.

## enums.hpp
- ëª©ì : `ActKind/BiasKind` **ë‹¨ì¼ ì†ŒìŠ¤**(ABI ê³ ì •).

## ai_stream.hpp
- ëª©ì : `StreamHandle=cudaStream_t` í‘œì¤€í™”, `as_cuda_stream`.

## ai_capture.hpp
- ëª©ì : CUDA Graph ìº¡ì²˜ ìƒíƒœ ì¡°íšŒ/ê¸ˆì§€ ê°€ë“œ(`AI_CAPTURE_FORBID_IF_ACTIVE`).

## ai_cuda_check.hpp
- ëª©ì : CUDA ì˜¤ë¥˜ â†’ `Status` ë§¤í•‘ ë§¤í¬ë¡œ(`AI_CUDA_CHECK/TRy/LAUNCH`).

## ai_memops.hpp
- ëª©ì : ìº¡ì²˜-ì„¸ì´í”„ memcpy/memset/alloc/free ë˜í¼.
- í‘œì¤€ API: `copy_{d2d,h2d,d2h}_async`, `set_d_async`, `alloc_d`, `free_d`.
- Deprecated: `memcpy_*` ì˜› ì´ë¦„ì€ ì–‡ì€ í¬ì›Œë”©ë§Œ.

## numeric.hpp
- ëª©ì : `fits_int32(int64_t)` ë‹¨ì¼ ì†ŒìŠ¤.

## layout.hpp
- ëª©ì : Row-major LD ìœ íš¨ì„±/ê¸°ë³¸ê°’(`valid_ld_rowmajor`, `resolve_ld`).

## tensor_layout.hpp
- ëª©ì : strideâ†’LD ì¶”ë¡ /`Z` ë²„í¼ ê²€ì¦(`infer_ld_rowmajor_2d`, `validate_z_buffer`).

## ai_tensor.hpp
- ëª©ì : ë¹„ì†Œìœ  í…ì„œ ë·°/Descriptor, ê¸°ë³¸ LD í—¬í¼.

## ai_validate.hpp
- ëª©ì : í…ì„œ ì†ì„± ê²€ì¦(Status ë°˜í™˜), NCHW íŒŒì‹±/axis ì •ê·œí™”.

## ai_nvtx.hpp
- ëª©ì : NVTX Range/Mark (no-op í† ê¸€).

## workspace.hpp
- ëª©ì : ì›Œí¬ìŠ¤í˜ì´ìŠ¤ ì •ë ¬ ê²€ì‚¬(ê¸°ë³¸ 256B).

## math_compat.hpp *(ì„ íƒ)*
- ëª©ì : `expf_compat/tanhf_compat` ë“± device/host í†µí•© math.

## activations.hpp *(Heavy)*
- ëª©ì : í™œì„±í™” forward/derivative(í…œí”Œë¦¿/ëŸ°íƒ€ì„), `ActKind`ëŠ” `enums.hpp` ì°¸ì¡°.

## bias.hpp *(Heavy)*
- ëª©ì : Bias ë¡œë“œ/í•©ì‚°, 1D ê¸¸ì´ ê¸°ë°˜ `BiasKind` ì¶”ë¡ .

## traits.hpp *(Heavy)*
- ëª©ì : ì»´íŒŒì¼íƒ€ì„ ì—í•„ë¡œê·¸ ì •ì±…(`Epilogue<AK,BM,HasC,SaveZ>`).

## epilogue_functors.hpp *(Heavy)*
- ëª©ì : ëŸ°íƒ€ì„ ì—í•„ë¡œê·¸ ì¡°ë¦½(Î±Â·acc + Î²Â·C + bias â†’ act â†’ (opt)dropout/Z).

## ai_ops_base.hpp
- ëª©ì : `GemmAttrs`(ëŸ°íƒ€ì„ ë©”íƒ€) ì •ì˜. `ActKind`ëŠ” `enums.hpp`ì—ì„œë§Œ.
