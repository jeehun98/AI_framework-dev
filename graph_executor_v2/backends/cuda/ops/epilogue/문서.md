cmake --build build -j --target ge2_epilogue_policy
cmake --build build -j --target _ops_epilogue

# Epilogue 독립 모듈

## 개요
`Y = Dropout( Act( X + Bias ) )`를 CUDA 커널 한 번으로 수행.  
정책(타일/벡터화), 활성화, 드롭아웃, 타입(f16/f32)을 분리된 레이어로 관리.

## 파일 구조
- `api/`: 외부 API (`run`), DType/Plan/Attrs/Tensors 정의
- `kernels/policy/`: 수학 함수, functor, 타일/런치 정책, traits
- `kernels/`: Params, Philox, CUDA 커널 본체, dispatch
- `launcher/`: dtype별 정책 런처의 외부 심볼
- `pybind/`: 파이썬 바인딩 (선택)

## 빌드 포인트
- `compute_80+` 권장. `cuda_fp16.h` 사용(Windows/MSVC 포함).
- 드롭아웃 RNG는 경량 Philox-like 스텁: 재현성이면 충분, 보안/정밀 난수는 `curand_philox4x32_10`로 교체 가능.

## 사용 예 (C++)

```cpp
epi::Plan p;
p.rows = M; p.cols = N;
p.ld_x = N; p.ld_y = N; p.ld_bias = N;
p.attrs.act = epi::ActKind::GELU;
p.attrs.dropout_p = 0.1f;
p.attrs.save_mask = true;
p.attrs.seed = 1234ULL;

epi::Tensors t{ x, bias, y, mask };
cudaError_t st = epi::run(p, t, epi::DType::F32);
