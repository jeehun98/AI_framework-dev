:: 기본 (act/bias 없음, beta=0)
.\bench_regemm 2048 2048 2048 30

:: ReLU + perN bias
.\bench_regemm 2048 2048 2048 30 1.0 0.0 1 1

:: beta=1 (C 읽음) + scalar bias
.\bench_regemm 2048 2048 1024 50 1.0 1.0 0 3


# Benchmarks
- Default tile: 128×128×16, block 16×16, thr tile 8×8
- Measure avg over 50 iters after 5 warmups
- Report: time (ms), TFLOP/s

## Suggested Sweeps
- K ∈ {128, 256, 512, 1024, 2048}
- (BM,BN,BK) ∈ {(64,128,16), (128,128,16), (128,256,32)}
- REGEMM_USE_DB ∈ {ON, OFF}
- REGEMM_USE_VECIO ∈ {ON, OFF}



# Benchmarks

이 문서는 `regemm_epilogue` 모듈의 성능 및 정확성 확인용 벤치마크 결과를 정리합니다.

## GEMM + Bias + Activation (M=1024, N=1024, K=1024)

| Activation | Time (ms) | TFLOP/s | L2 Error | Max Abs Error | 샘플 값 (GPU vs CPU) |
|------------|-----------|---------|----------|---------------|-----------------------|
| **None**      | 1.023 | 2.10 | 0.000e+00 | 0.000e+00 | 13.10762 / 13.10762<br>3.90409 / 3.90409<br>7.63981 / 7.63981<br>-4.93886 / -4.93886<br>2.88339 / 2.88339<br>-3.07939 / -3.07939 |
| **ReLU**      | 1.053 | 2.04 | 0.000e+00 | 0.000e+00 | 13.10762 / 13.10762<br>3.90409 / 3.90409<br>7.63981 / 7.63981<br>0.00000 / 0.00000<br>2.88339 / 2.88339<br>0.00000 / 0.00000 |
| **LeakyReLU** | 0.988 | 2.17 | 0.000e+00 | 0.000e+00 | 13.10762 / 13.10762<br>3.90409 / 3.90409<br>7.63981 / 7.63981<br>-0.04939 / -0.04939<br>2.88339 / 2.88339<br>-0.03079 / -0.03079 |
| **GELU**      | 1.027 | 2.09 | 9.043e-09 | 2.384e-07 | 13.10762 / 13.10762<br>3.90398 / 3.90398<br>7.63981 / 7.63981<br>-0.00000 / -0.00000<br>2.87816 / 2.87816<br>-0.00281 / -0.00281 |
| **Sigmoid**   | 0.762 | 2.82 | 1.703e-08 | 1.788e-07 | 1.00000 / 1.00000<br>0.98024 / 0.98024<br>0.99952 / 0.99952<br>0.00711 / 0.00711<br>0.94702 / 0.94702<br>0.04397 / 0.04397 |
| **Tanh**      | 0.786 | 2.73 | 9.638e-09 | 1.192e-07 | 1.00000 / 1.00000<br>0.99919 / 0.99919<br>1.00000 / 1.00000<br>-0.99990 / -0.99990<br>0.99376 / 0.99376<br>-0.99578 / -0.99578 |

### Notes
- 모든 활성화에서 **GPU와 CPU 결과 일치** (오차는 float32 허용 범위).
- ReLU / LeakyReLU는 완벽히 일치.
- Sigmoid / Tanh / GELU는 transcendental 함수 사용으로 ~1e-7 수준 차이 발생 → 정상.
- 성능은 2.0 ~ 2.8 TFLOP/s 수준.
